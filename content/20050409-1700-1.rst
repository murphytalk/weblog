##############
服务器不稳定中
##############
:category: Computer
:tags: Linux
:date: 2005-04-09 17:00



kernel panic ...

这周服务器突然变得极不稳定，kernel经常dump。开始常见是由iptables引发的异常，怀疑是不是新买的连ADSL的网卡不稳定，和LAN网卡对调后依旧存在问题。今天改用slackware自带的2.4.29的kernel试了试，kernel依旧dump，只不过起因变成了wine。

主板存在硬件隐患的可能性较大（AGP槽已经废掉了）。BIOS里好像没有禁止AGP的设置，于是重新编译了2.9.11.6的kernel，取消了所有和AGP有关的选项；另外停掉了wine和eMule ... 到现在跑了4个小时似乎正常。

现在在用aMule代替eMule，大多数设置文件似乎是和eMule兼容的（包括最重要的狗牌），但是累计统计信息就不一样了。用的是aMule的今天的cvs版本，没有编译GUI，只编译了daemon和web管理服务。如下设置编译::

 ./configure --enable-amulecmd --enable-webserver \\
   --disable-monolithic --enable-amule-daemon --disable-debug \\
   --enable-optimise

Web管理服务是一个独立的程序，默认通过4712端口和amuled（或者aMule GUI）通信。这个daemon倒是很有unix特色，喜欢。不知道什么时候能支持KAD。

目前有几个问题:

1 网页编码默认不是gb-2312。虽然我改了下web template，未奏效。

2 verycd提供的ed2k link中的文件名都包含中文，编码当是utf8，amule不认识。所以暂时只好手工把ed2k link中的中文部分去掉。

3 居然每次只能认一个ed2k link，有些link还会让emulweb死掉。真脆弱啊。

第二点可能得自己改程序，libconv应该可以用上 ...