########################################
关于用c/c++写供VB程序调用的DLL
########################################
:category: Computer
:tags: C/C++
:date: 2005-09-06 17:00



注意两个问题：函数参数传递方式和函数名的导出方式

三菱电车的相关项目，PC端无论是供调试用的模拟器还是实际装车的监控用程序，几乎一贯都是用VB写的。虽然VB的语法我是一点也不喜欢，但把它作为一个快速的应用搭建工具和粘合语言还是不错的。VB本身不太擅长的工作可以交由别的语言完成，比方说现在手头的电车的显示器模拟器的通信和CRC校验运算部分。

用c/c++写供VB调用的DLL时需要注意一下几点:

1. 参数传递方式:VB使用的是Windows API函数的标准传参方式__stdcall，和c/c++的默认方式__cdel类似也是从右到左往堆栈，不同之处在于它是由被调用者从堆栈中清除参数的。

2. 函数的导出方式:用c/c++的dllexport会导致输出的函数名后被加上@和序号，VB不能认识。需要在DEF文件中指明输出函数的名称，和c函数名一致即可。