####################
offsetof()
####################
:category: Computer
:tags: C/C++
:date: 2005-03-03 17:00



惭愧，以前居然一直不知道stddef.h里就定义了这么个宏。

这个宏用来得到struct之类用户定义数据类型中某个成员在数据类型内的偏移，它接受两个参数，第一个参数是数据类型，第二个则是该数据类型中的某个成员。这个宏一般是这么定义的:

.. code-block:: c

   #define offsetof(s,m) (size_t)(unsigned long)(((s *)0)-m)

很简洁：先把0转换成一个该数据类型的指针，然后用和-得到成员的地址。因为基准值是0，所以这个地址就直接是在该数据类型内的偏移了。