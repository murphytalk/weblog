####################################
Diable MDI子窗口的关闭按钮
####################################
:category: Computer
:tags: C/C++
:date: 2005-03-23 17:00



Old school MFC/WinSDK tricks ;)

在做TRC4模拟器项目时用到的。首先为CChildFrame增加如下成员函数:

 .. code-block:: cpp
    
    void  CChildFrame::DisableCloseButton()
    {
    	CWnd *pView=GetWindow(GW_CHILD);
    
    	if(pView-IsKindOf(RUNTIME_CLASS(CTrcEmulatorView))){
    		CMenu* pSysMenu = GetSystemMenu(FALSE);
    		pSysMenu-EnableMenuItem( SC_CLOSE, MF_BYCOMMAND|MF_GRAYED);
    	}	
    }

其中对view class的RUNTIME_CLASS判断是确保只有当该种类型的子窗口打开时才disable子窗口的关闭按钮。

在 **CChildFrame::OnCreateClient()** 中调用上述函数即可。