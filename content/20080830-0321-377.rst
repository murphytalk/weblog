########################################################################
根据指定日期得到该日所在星期任意星期几的日期的bash script函数
########################################################################
:category: Computer
:tags: Linux
:date: 2008-08-30 03:21



在写bash 脚本自动下载种类繁多的日报、周报、月次月报、周次月报。。。的时候，需要一个根据指定日期，得到该日所在星期任意星期几的日期的功能。本来以为很好很强大的date命令可以轻松做到，摆弄了下发现它的next mon啊last mon是依赖于调用时日期的，用起来很让人迷惑易犯错，于是自己写了个bash script函数。

参数是指定日期和改日期所在星期的星期几（1~7），然后返回这天的年月日::

 get_date_by_weekday(){
    #$1 date in YYYY-MM-DD format
    #$2 week day number of the week of $1, where 1 is Monday
    #returns the date into $Y $M $D of the speicfied day

    WEEKDAY=`date -d "$1" +%u`

    OFFSET[1]=`expr 1 - $WEEKDAY`
    OFFSET[2]=`expr 2 - $WEEKDAY`
    OFFSET[3]=`expr 3 - $WEEKDAY`
    OFFSET[4]=`expr 4 - $WEEKDAY`
    OFFSET[5]=`expr 5 - $WEEKDAY`
    OFFSET[6]=`expr 6 - $WEEKDAY`
    OFFSET[7]=`expr 7 - $WEEKDAY`

    DT=$(date -d "$1 ${OFFSET[$2]} days" +%Y%m%d)

    Y=$(echo "${DT:0:4}" )
    M=$(echo "${DT:4:2}" )
    D=$(echo "${DT:6:2}" )
 }


